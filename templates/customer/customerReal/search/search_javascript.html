{% load staticfiles %}

<script>

    $(".show-menu").click(function () {

        var div = document.getElementById('profile-preview');
        while (div.firstChild) {
            div.removeChild(div.firstChild);
        }

        //lOAD THE PROFILE VIEW
        $('#profile-preview').load("{% static 'html_templates/page_layout.html' %}");

        //TURN MENU OPTION HTML TO ONE LINE SO APPEND WILL WORK PROPERLY
        var body;
        var menu = "";
        $.get("{% static 'html_templates/menu_preview.html' %}", function (txt) {
            body = txt.split('\n');
            for (var i = 0; i < body.length; i++) {
                menu += body[i];
            }
        });

        $.ajax({
            url: $("."+$(this).attr('value')).attr('data-field1'),
            dataType: 'json',
            success: function (outputfromserver) {
                for (var j = 0; j < outputfromserver.length; j++) {
                    $("#menu-start").append(menu);
                }

                $('.menu-name').each(function (i) {
                    $(this).append(outputfromserver[i].name);
                });
            }
        });
    });

</script>