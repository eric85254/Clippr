{% load staticfiles %}

<script>

    $(".show-menu").click(function () {

        var div = document.getElementById('profile-preview');
        while (div.firstChild) {
            div.removeChild(div.firstChild);
        }

        //lOAD THE PROFILE VIEW
        $('#profile-preview').load("{% static 'html_templates/preview_layout.html' %}");

        //TURN MENU OPTION HTML TO ONE LINE SO APPEND WILL WORK PROPERLY
        var menuBody;
        var menuHTML = "";
        $.get("{% static 'html_templates/menu_preview.html' %}", function (txt) {
            menuBody = txt.split('\n');
            for (var i = 0; i < menuBody.length; i++) {
                menuHTML += menuBody[i];
            }
        });

        //TURN PORTFOLIO HTML TO ONE LINE SO APPEND WILL WORK PROPERLY
        var portfolioBody;
        var portfolioHTML;
        $.get("{% static 'html_templates/portfolio_preview.html' %}", function (txt) {
            portfolioBody = txt.split('\n');
            for (var i = 0; i < portfolioBody.length; i++) {
                portfolioHTML += portfolioBody[i];
            }
        });

        //PUT PORTFOLIO IN PAGE
        $.ajax({
            url: $("." + $(this).attr('value')).attr('data-field1'),
            dataType: 'json',
            success: function (outputfromserver) {

                var menu = {};
                var portfolio = {};

                for (var i = 0, port; i < outputfromserver.portfolio_haircuts.length; i++) {
                    port = outputfromserver.portfolio_haircuts[i];
                    portfolio[i] = port;
                }

                for (var k = 0, menu_items; k < outputfromserver.stylist_menu.length; k++) {
                    menu_items = outputfromserver.stylist_menu[k];
                    menu[k] = menu_items;
                }


                //Give html block for each menu option
                for (var j = 0; j < outputfromserver.stylist_menu.length; j++) {
                    $("#menu-start").append(menuHTML);
                }

                //Give html block for each portfolio option
                for (j = 0; j < outputfromserver.stylist_menu.length; j++) {
                    $("#portfolio-start").append(portfolioHTML);
                }

                //Write name of menu item in each menu-name class
                $('.menu-name').each(function (p) {
                    $(this).append(menu[p].name);
                });

                //Write price of menu option in each menu-price class
                $('.menu-price').each(function (k) {
                    $(this).append('$' + menu[k].price);
                });
            }
        });
    });

</script>